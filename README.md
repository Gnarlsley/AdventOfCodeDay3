Solved using Regex objects in C#, second task relied on state based logic.
